"use strict";(self["webpackChunkhexschool_vue_week6_work"]=self["webpackChunkhexschool_vue_week6_work"]||[]).push([[684],{3684:function(t,a,e){e.r(a),e.d(a,{default:function(){return f}});var s=e(6252),n=e(3577),r=e(9963);const i=(0,s._)("h2",null,"購物車",-1),l={class:"table align-middle"},o=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th"),(0,s._)("th",null,"品名"),(0,s._)("th",{style:{width:"150px"}},"數量/單位"),(0,s._)("th",null,"單價"),(0,s._)("th",{style:{width:"150px"}},"小計")])],-1),c=["onClick"],d={class:"input-group input-group-sm"},u={class:"input-group mb-3"},h=["onUpdate:modelValue","onBlur"],p={class:"input-group-text",id:"basic-addon2"},_={style:{width:"150px"},class:"text-center"},g=(0,s._)("td",{colspan:"4",class:"text-end"},[(0,s._)("strong",null,"總計")],-1);function w(t,a,e,w,y,m){const b=(0,s.up)("Loading");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(b,{active:y.isLoading,loader:"dots"},null,8,["active"]),i,(0,s._)("table",l,[o,(0,s._)("tbody",null,[y.cartData?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:0},(0,s.Ko)(y.cartData,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id},[(0,s._)("td",null,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:a=>m.deleteProduct(t.id,t.product.title)}," x ",8,c)]),(0,s._)("td",null,(0,n.zw)(t.product.title),1),(0,s._)("td",null,[(0,s._)("div",d,[(0,s._)("div",u,[(0,s.wy)((0,s._)("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":a=>t.qty=a,onBlur:a=>m.updatedCart(t.id,t.qty)},null,40,h),[[r.nr,t.qty,void 0,{number:!0}]]),(0,s._)("span",p,(0,n.zw)(t.product.unit),1)])])]),(0,s._)("td",null,(0,n.zw)(t.product.price),1),(0,s._)("td",null,[(0,s._)("div",_,(0,n.zw)(t.total),1)])])))),128)):(0,s.kq)("",!0)]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[g,(0,s._)("td",null,[(0,s._)("strong",null,(0,n.zw)(y.grand_total),1)])])])])])}e(1703);const y="https://vue3-course-api.hexschool.io/v2/api/abbie-vue";var m={data(){return{cartData:{},grand_total:0,isLoading:!1}},methods:{async getCarts(){try{this.isLoading=!0;const{data:t}=await this.$http.get(`${y}/cart`);this.cartData=t.data.carts,this.isLoading=!1}catch(t){throw new Error(t.messages)}},async updatedCart(t,a){try{if(this.isLoading=!0,a<=0)return this.$swal.fire({icon:"error",title:"數量不可少於1"}),void this.getCarts();const e={product_id:t,qty:a},s=await this.$http.put(`${y}/cart/${t}`,{data:e});this.$swal.fire({icon:"success",title:s.data.message}),this.getCarts(),this.isLoading=!1}catch(e){throw new Error(e.messages)}},async deleteProduct(t,a){try{const e=confirm(`確定刪除 ${a} ？`);if(!e)return;this.isLoading=!0;await this.$http.delete(`${y}/cart/${t}`);this.getCarts(),this.isLoading=!1}catch(e){throw new Error(e.message)}},calcGrandTotal(){const t=this.cartData.map((t=>t.total));let a=0;t.forEach((t=>a+=t)),this.grand_total=a}},watch:{cartData(){this.calcGrandTotal()}},created(){this.getCarts()}},b=e(3744);const v=(0,b.Z)(m,[["render",w]]);var f=v}}]);
//# sourceMappingURL=684.f73ea603.js.map