"use strict";(self["webpackChunkhexschool_vue_week6_work"]=self["webpackChunkhexschool_vue_week6_work"]||[]).push([[322],{6322:function(t,o,s){s.r(o),s.d(o,{default:function(){return O}});var a=s(6252),d=s(3577);const r={class:"row row-cols-auto mx-auto"},e=(0,a._)("h2",{class:"col-12"},"產品列表",-1),i={class:"card my-2",style:{border:"none"}},c=["src"],l={class:"card-body"},n={class:"card-title"},u={class:"card-text"},p=(0,a.Uk)(" 特價 "),h={class:"text-danger"},m=(0,a.Uk)(" ／ "),b={class:"text-secondary ms-auto"},w={class:"d-flex justify-content-evenly"},g=["onClick"],_=["onClick"],y={key:0,class:"col-12 mt-5"};function v(t,o,s,v,k,f){const C=(0,a.up)("Loading"),$=(0,a.up)("UserProductModal");return(0,a.wg)(),(0,a.iD)("div",r,[(0,a.Wm)(C,{active:k.isLoading,loader:"dots"},null,8,["active"]),e,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(k.products,(t=>((0,a.wg)(),(0,a.iD)("div",{class:"col-6 col-sm-4 col-md-3",key:t.id},[(0,a._)("div",i,[(0,a._)("img",{src:t.imageUrl,class:"card-img-top",style:{height:"15rem","object-fit":"cover"}},null,8,c),(0,a._)("div",l,[(0,a._)("h5",n,(0,d.zw)(t.title),1),(0,a._)("div",u,[p,(0,a._)("strong",h,"$ "+(0,d.zw)(t.price),1),m,(0,a._)("s",null,"$ "+(0,d.zw)(t.origin_price),1),(0,a._)("p",b,(0,d.zw)(t.content),1)]),(0,a._)("div",w,[(0,a._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:o=>f.openProductModal(t.id)}," More ",8,g),(0,a._)("button",{type:"button",class:"btn btn-main",onClick:o=>f.addToCart(t.id,1)}," ＋ ",8,_)])])])])))),128)),(0,a.Wm)($,{ref:"UserProductModal",product:k.product,onAfterAddCart:f.addToCart},null,8,["product","onAfterAddCart"]),0===k.products.length?((0,a.wg)(),(0,a.iD)("h5",y,"暫不供應")):(0,a.kq)("",!0)])}s(1703);var k=s(9963);const f={class:"modal fade",id:"productModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",ref:"modal"},C={class:"modal-dialog"},$={class:"modal-content"},M={class:"modal-header"},x={class:"modal-title",id:"staticBackdropLabel"},U=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),L={class:"modal-body"},q={class:"row"},z={class:"col-sm-6"},P={class:"col-sm-6 text-start"},T=(0,a.Uk)(" 商品特色： "),D={class:"text-start"},A=(0,a.Uk)(" 商品內容： "),j={class:"h5"},E={class:"h6 ms-auto"},B={class:"input-group"},W=(0,a._)("label",{for:"qty"},"數量：",-1),Z={class:"modal-footer"},H=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);function I(t,o,s,r,e,i){return(0,a.wg)(),(0,a.iD)("div",f,[(0,a._)("div",C,[(0,a._)("div",$,[(0,a._)("div",M,[(0,a._)("h5",x,(0,d.zw)(s.product.title),1),U]),(0,a._)("div",L,[(0,a._)("div",q,[(0,a._)("div",z,[(0,a._)("div",{class:"w-100 me-3",style:(0,d.j5)([{width:"200px",height:"300px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${s.product.imageUrl})`}])},null,4)]),(0,a._)("div",P,[T,(0,a._)("p",D,(0,d.zw)(s.product.description),1),A,(0,a._)("p",null,(0,d.zw)(s.product.content),1),(0,a._)("div",j,[(0,a.Uk)((0,d.zw)(s.product.price)+" 元 ",1),(0,a._)("del",E,"原價 "+(0,d.zw)(s.product.origin_price)+" 元",1)]),(0,a._)("div",B,[W,(0,a.wy)((0,a._)("input",{type:"number",class:"form-control",min:"0","onUpdate:modelValue":o[0]||(o[0]=t=>e.qty=t),id:"qty"},null,512),[[k.nr,e.qty,void 0,{number:!0}]])])])])]),(0,a._)("div",Z,[H,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:o[1]||(o[1]=(...t)=>i.addToCart&&i.addToCart(...t))}," 加入購物車 ")])])])],512)}var K={name:"UserProductModal",props:["product"],data(){return{modal:"",qty:1}},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()},addToCart(){if(this.qty<0)return this.qty=1,void this.$swal.fire({icon:"warning",title:"數量不可為0，請重新選購"});this.$emit("after-add-cart",this.product.id,this.qty),this.hideModal()}},mounted(){const t=s(7244);this.modal=new t.Modal(this.$refs.modal,{keyboard:!1,backdrop:"static"})}},V=s(3744);const Y=(0,V.Z)(K,[["render",I]]);var F=Y;const G="https://vue3-course-api.hexschool.io/v2/api/abbie-vue";var J={name:"ProductList",components:{UserProductModal:F},data(){return{isLoading:!1,products:{},product:{}}},methods:{async getProducts(){try{this.isLoading=!0;const t=await this.$http.get(`${G}/products`);this.products=t.data.products,this.isLoading=!1}catch(t){throw new Error(t.message)}},async openProductModal(t){try{this.isLoading=!0;const o=await this.$http.get(`${G}/product/${t}`);this.product=o.data.product,this.$refs.UserProductModal.openModal(),this.isLoading=!1}catch(o){throw new Error(o.message)}},async addToCart(t,o){try{if(o<=0)return void this.$swal.fire({icon:"warning",title:"數量不可少於1，請重新選購"});this.isLoading=!0;const s={product_id:t,qty:o},a=await this.$http.post(`${G}/cart`,{data:s});this.isLoading=!1,this.$swal.fire({icon:"success",title:a.data.message})}catch(s){throw new Error(s.message)}}},created(){this.getProducts()}};const N=(0,V.Z)(J,[["render",v]]);var O=N}}]);
//# sourceMappingURL=322.86693b46.js.map